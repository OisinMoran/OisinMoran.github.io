<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" style="background-color: black">
  <defs>
    <link xmlns="http://www.w3.org/1999/xhtml" href="http://fonts.googleapis.com/css?family=Ultra" rel="stylesheet" type="text/css" />
    <style type="text/css">
      <![CDATA[   

      ::selection {
        background: black;
      }

      ::-moz-selection {
        background: black;
      }


      .filtered{
        filter: hue-rotate(90);
      }
      ]]>

    </style>

    <linearGradient id="gradient">
      <stop offset="0" stop-color="white"/>
      <stop offset="0.5" stop-color="black"/>
      <stop offset="1" stop-color="white"/>
    </linearGradient>

    <pattern id="pattern" patternUnits="userSpaceOnUse" width="10" height="10"> <image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMCcgaGVpZ2h0PScxMCc+CiAgPHJlY3Qgd2lkdGg9JzEwJyBoZWlnaHQ9JzEwJyBmaWxsPSd3aGl0ZScgLz4KICA8cmVjdCB4PScwJyB5PScwJyB3aWR0aD0nOScgaGVpZ2h0PSc5JyBmaWxsPSdibGFjaycgLz4KPC9zdmc+" x="0" y="0" width="10" height="10"> </image> </pattern>
   
   
    <pattern id="sqr" patternUnits="userSpaceOnUse" width="400" height="400">
        <image xlink:href="sqr.jpg" x="0" y="0" width="400" height="400"> </image>
    </pattern>

     <pattern id="circle" patternUnits="userSpaceOnUse" width="225" height="225">
        <image xlink:href="circle.png" x="0" y="0" width="225" height="225"> </image>
        <image xlink:href="circle.png" x="50" y="100" width="50" height="50"> </image>
    </pattern>


    <filter id="filter" color-interpolation-filters="sRGB">
      <feTurbulence
      id="noise"
      type="fractalNoise"
      baseFrequency="0.01"
      numOctaves="2"
      result="N" />
    </filter>

  </defs>

  <!-- <rect x="50%" y="50%" width="200" height="200" transform="translate(-100,-100)" fill="url(#pattern)" filter="url(#filter)"/> -->
  <rect x="50%" y="50%" width="400" height="400" transform="translate(-200,-200)" fill="url(#pattern)" filter="url(#filter)"/>


  <!-- <script type="text/javascript" href="./re.js"></script> -->
  <script type="text/javascript"><![CDATA[
    var n = 5;
    var k = 1 / (n*n - 1);
    var tings = []

    for (var i=0; i < n*n; i++) {
        if (i === Math.floor(n*n/2)) {
            tings.push(-1.0005);    
        }
        else {
            tings.push(k);
        }
    }

    var kernel = tings.join(" ");

    const noise = document.getElementById('noise');
    const bf = 0.01 + Math.random()*0.08;         // 0.01â€“0.09
    noise.setAttribute('baseFrequency', bf.toFixed(3));

    const sd = 2 + Math.random()*3;         // 2-5

    var x = document.getElementById("filter");
    var f = `<feGaussianBlur stdDeviation="${sd}"/>
             <feConvolveMatrix edgeMode="wrap" order="${n},${n}" kernelMatrix="${kernel}"/>
             <feColorMatrix in="prev" type="saturate" values="0" result="gray"/>  <!-- R=G=B -->
             <feComponentTransfer>
                <feFuncR type="discrete" tableValues="0 1"/>
                <feFuncG type="discrete" tableValues="0 1"/>
                <feFuncB type="discrete" tableValues="0 1"/>
             </feComponentTransfer>`

    let count = 0;
    const MAX = 200;

    function iterate() {
      if (count >= MAX) return;          
      x.insertAdjacentHTML('beforeend', f);
      count++;
      setTimeout(iterate, 30);
    }

    iterate();
  ]]></script>


</svg>



